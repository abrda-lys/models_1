<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>3D Model Viewer</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
    }

    #viewer {
      width: 100%;
      height: 100vh;
    }
  </style>
  <script src="https://developer.api.autodesk.com/viewingservice/v1/viewers/desktop/viewer3D.min.js"></script>
</head>
<body>
  <div id="viewer"></div>

  <script>
    // Ваши Client ID и Client Secret
    const clientId = KOl4YRq4ZMorDFdoZwyqRsskBrO32CSXRGq4WgGydMeiDGKq;
    const clientSecret = lYFHab24T8ZG8FCU2yL9u7lGnq16lfu0IWuedH3M7tWimxgbcoiA6vLDN6vbsmn5;
    
    // Функция для получения Access Token
    function getAccessToken() {
      const url = 'https://developer.api.autodesk.com/authentication/v1/authenticate';
      const data = {
        client_id: clientId,
        client_secret: clientSecret,
        grant_type: 'client_credentials',
        scope: 'data:read'
      };

      return fetch(url, {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: new URLSearchParams(data)
      })
      .then(response => response.json())
      .then(data => data.access_token)
      .catch(error => {
        console.error('Error getting access token:', error);
      });
    }

    // Функция для инициализации и отображения модели
    function launchViewer(urn) {
      getAccessToken().then(accessToken => {
        if (accessToken) {
          const options = {
            env: 'AutodeskProduction',
            accessToken: accessToken
          };

          Autodesk.Viewing.Initializer(options, function() {
            const viewerDiv = document.getElementById('viewer');
            const viewer = new Autodesk.Viewing.GuiViewer3D(viewerDiv);
            viewer.start();

            const documentId = 'urn:' + urn;  // Модель должна быть в формате URN
            Autodesk.Viewing.Document.load(documentId, onDocumentLoadSuccess, onDocumentLoadFailure);
          });
        }
      });
    }

    function onDocumentLoadSuccess(doc) {
      const viewable = doc.getRoot().getDefaultGeometry();
      viewer.loadDocumentNode(doc, viewable);
    }

    function onDocumentLoadFailure(viewerError) {
      console.error('Error loading document: ', viewerError);
    }

    // Загрузка модели
    launchViewer('model1'); // Замените на имя вашей модели (без расширения)
  </script>
</body>
</html>
