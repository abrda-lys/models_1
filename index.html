<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="https://storage.yandexcloud.net/mymodels/favicon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Текущие проекты. СтройОборудование.</title>
    <style>
        /* Твой стиль */
    </style>
    <script type="module" src="https://unpkg.com/@google/model-viewer@latest/dist/model-viewer.min.js"></script>
    <script>
        async function loadModels() {
            try {
                const response = await fetch('https://storage.yandexcloud.net/mymodels/models.txt', { mode: 'cors' });
                if (!response.ok) throw new Error(`Ошибка HTTP: ${response.status}`);
                const text = await response.text();
                const lines = text.split('\n').filter(line => line.trim() !== '');
                
                const grid = document.querySelector('.grid');
                grid.innerHTML = '';
                console.log("Загруженные данные:", lines);

                lines.forEach((line) => {
                    const [name, url] = line.split(',').map(part => part.trim());
                    if (name && url) {
                        const projectDiv = document.createElement('div');
                        projectDiv.className = 'project';
                        projectDiv.innerHTML = `
                            <a href="viewer.html?model=${encodeURIComponent(url)}" class="project-link">
                                <div class="model-container">
                                    <model-viewer 
                                        src="${url}" 
                                        poster="https://storage.yandexcloud.net/mymodels/label_1.png"
                                        camera-controls 
                                        crossOrigin="anonymous"
                                        camera-orbit="45deg 55deg 2.5m"
                                        interaction-prompt="none"
                                        field-of-view="30deg"
                                        style="width:100%;height:100%">
                                    </model-viewer>
                                </div>
                                <p class="project-title">${name}</p>
                            </a>
                        `;
                        grid.appendChild(projectDiv);
                    } else {
                        console.error(`Ошибка в строке: ${line}. Некорректный формат.`);
                    }
                });
            } catch (error) {
                console.error("Ошибка загрузки списка моделей:", error);
                document.querySelector('.grid').innerHTML = `
                    <div style="grid-column:1/-1;text-align:center;color:red;">
                        Ошибка загрузки данных. Пожалуйста, проверьте файл.
                    </div>
                `;
            }
        }

        document.addEventListener("DOMContentLoaded", loadModels);
    </script>
</head>
<body>
    <div class="container">
        <h1>Текущие проекты. СтройОборудование.</h1>
        <div class="grid">
            <!-- Модели загружаются через JavaScript -->
        </div>
    </div>
</body>
</html>
